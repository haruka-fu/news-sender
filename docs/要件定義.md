# 技術記事配信システム 要件定義

## 概要

毎朝9時、ユーザーが登録したテーマに沿った技術記事をDiscord DMで配信するシステム。

## ユーザー

- 想定ユーザー数: 10人程度
- 1人あたり配信件数: 10〜30件/日

## 技術スタック

```txt
Next.js (TypeScript) - Vercel
├── /api/interactions    ← スラッシュコマンド受付
├── /api/cron/fetch      ← 記事取得（定期実行）
├── /api/cron/deliver    ← 毎朝9時配信
Supabase
├── users（Discord ID等）
├── themes（テーマ + embedding）
├── articles（記事 + embedding）
OpenAI API
├── text-embedding-3-small
Discord
├── Interactions API（コマンド受付）
├── Bot DM（記事配信）
```

## データソース（MVP）

| ソース | 取得対象 |
|--------|----------|
| Qiita | トレンド記事 |
| Zenn | トレンド記事 |
| はてなブックマーク | テクノロジーカテゴリ |

## 機能一覧

### スラッシュコマンド

| コマンド | 説明 |
|----------|------|
| `/register` | ユーザー登録 |
| `/theme add [テーマ]` | 興味テーマ追加（例: React, AWS, セキュリティ） |
| `/theme list` | 登録中のテーマ一覧 |
| `/theme remove [テーマ]` | テーマ削除 |
| `/settings` | 配信ON/OFF、件数設定 |

### 定期実行

| 処理 | タイミング | 内容 |
|------|------------|------|
| 記事取得 | 毎日早朝 | 各ソースから新着記事を取得、Embedding生成 |
| 配信 | 毎朝9時 | ユーザーごとにマッチした記事をDM配信 |

### 配信フォーマット

```txt
📰 今日のおすすめ記事（10件）

🏷️ React
• タイトル1 - Qiita
  https://...

• タイトル2 - Zenn
  https://...

🏷️ AWS
• タイトル3 - はてブ
  https://...
```

## マッチングロジック

1. ユーザーが登録したテーマをEmbedding化して保存
2. 取得した記事（タイトル + 概要）をEmbedding化
3. コサイン類似度でマッチング
4. 類似度が高い順に指定件数を配信

## コスト見込み

| 項目 | 月額目安 |
|------|----------|
| OpenAI Embedding | 〜$0.05 |
| Supabase | 無料枠内 |
| Vercel | 無料枠内 |
| **合計** | **ほぼ無料** |

予算: 10ユーザー × 月100円 = 月1,000円以内

## 非機能要件

- 可用性: 毎朝の配信が確実に行われること
- 拡張性: 将来的にデータソース追加が容易な設計
- セキュリティ: Discord認証によるユーザー管理
